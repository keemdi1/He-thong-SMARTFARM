<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">  
  <title>H·ªá th·ªëng Smartfarm IoT</title>
  <link rel="stylesheet" href="style.css" />
  <style>
      .menu-toggle {
        display: none;
        font-size: 28px;
        position: absolute;
        top: 41px;  
        right: -2px;
        cursor: pointer;
        color: white;
        z-index: 1000;
        text-align: center; /* cƒÉn gi·ªØa ch·ªØ b√™n d∆∞·ªõi */
      }

      .menu-toggle .menu-label {
        font-size: 12px;      /* ch·ªØ nh·ªè h∆°n icon */
        color: white;
        margin-top: 2px;      /* kho·∫£ng c√°ch gi·ªØa icon v√† ch·ªØ */
      }


   .header-container {
    position: relative; /* ƒë·ªÉ logo absolute d·ª±a v√†o ƒë√¢y */
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    padding: 10px;
}

      /* K√≠ch th∆∞·ªõc m·∫∑c ƒë·ªãnh tr√™n PC */
      .header-container h1 {
        font-size: 26px;
        margin: 0;
      }
    
    .header-text h1 {
      font-size: 24px;
      margin: 0;
      line-height: 1.3;
      color: white;
    }

    .header-text p {
      margin: 4px 0 0 0;
      font-size: 15px;
      color: white;
    }

    /* PC hi·ªÉn th·ªã ngang v√† c√≥ kho·∫£ng c√°ch */
    .info-mobile {
      text-align: center;
      font-size: 22px;
      margin-top: 30px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 50px;   /* t·∫°o kho·∫£ng c√°ch gi·ªØa c√°c nh√≥m */
    }

    @media screen and (max-width: 768px) {

      header {
        padding: 25px 10px;
      }
      
    .header-container h1 {
        font-size: 20px; /* ch·ªØ nh·ªè h∆°n tr√™n mobile */
        margin-left: 200px;
      }

      .header-container p {
        font-size: 14px; /* ch·ªØ m√¥ t·∫£ nh·ªè h∆°n */
        margin-left: -20px; 
      }

      .header-container > div > img.logo { 
          width: 33px;      
          height: auto;     
          position: absolute; 
          top: 46px;        
          left: -2px;        
          margin: 0;         
      }


      #status {
        transform: scale(1);
        transform-origin: top center;
      }

        /* Ch·ªâ √°p d·ª•ng cho Tab 1 */
      #status .status-box {
        display: grid;
        grid-template-columns: 1fr 1fr; /* 2 c·ªôt tr√™n mobile */
        gap: 12px;
        font-size: 15px;
      }

      #status .status-box div {
        background: #e8f5e9;
        border: 1px solid #c8e6c9;
        border-radius: 10px;
        padding: 10px;
        text-align: center;
        font-weight: bold;
        display: flex;
        flex-direction: column; /* icon tr√™n, ch·ªØ d∆∞·ªõi */
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      }

      #status .status-box img {
        width: 36px;
        height: 36px;
        margin-bottom: 5px;
      }

      /* Info c·∫£m bi·∫øn: c≈©ng chia 2 c·ªôt */
      #status .info-mobile {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin-top: 20px;
        font-size: 15px;
        text-align: center;
      }

      #status .info-mobile div {
        background: #f1f8e9;
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 1px 4px rgba(0,0,0,0.08);}


      #status .card {
        padding: 12px;
        border-radius: 8px;
        font-size: 13px;
      }

      #status .card img {
        width: 38px;
      }

      #status .status-box div {
        padding: 6px 10px;
      }

      .info-mobile strong {
        display: inline;
      }

      .info-mobile {
          flex-direction: column;
          align-items: center;
          text-align: center;
          font-size: 16px;
          gap: 10px;
          margin-left: 10px;
        }

      nav {
        flex-direction: column;
        display: none;
      }

      nav.show {
        display: flex;
      }

      .menu-toggle {
        display: block;
      }

      .tab-content {
        padding: 10px;
      }

      body {
        font-size: 14px;
      }

        .control-box {
        gap: 10px;         /* Gi·∫£m kho·∫£ng c√°ch gi·ªØa c√°c kh·ªëi */
        padding: 0 10px;   /* Thu h·∫πp l·ªÅ trong */
      }

      .device-control {
        width: 110px;           /* Gi·∫£m chi·ªÅu r·ªông */
        padding: 12px;          /* Gi·∫£m padding */
      }

      .device-control img {
        width: 45px;            /* Gi·∫£m k√≠ch th∆∞·ªõc h√¨nh ·∫£nh */
      }

      .device-control h3 {
        font-size: 15px;        /* Nh·ªè ch·ªØ t√™n thi·∫øt b·ªã */
      }

      .device-control .btn-group button {
        font-size: 13px;
        padding: 6px 10px;
      }

      .plant-detail {
        flex-direction: column;
        align-items: center;
      }

      .plant-detail img {
        width: 160px;
      }

      .plant-info {
        margin-top: -35px;
        margin-left: 10px;
        font-size: 15px;
      }

      .pop-content {
        margin: 120px auto 0 auto;
        width: 70%;          /* Gi·∫£m chi·ªÅu r·ªông popup */
        padding: 20px 10px 3px 10px;
      }

      .plant-item {
        width: 45%;          /* Hai c√¢y gi·ªëng tr√™n 1 h√†ng */
      }

      .plant-item img {
        width: 85%;         /* H√¨nh ·∫£nh ƒë·∫ßy ph·∫ßn item */
        height: auto;        /* Gi·ªØ t·ªâ l·ªá ·∫£nh */
      }

      /* Hi·ªÉn th·ªã popup */
      .auto-popup {
        display: flex;
        align-items: center;
        position: fixed;
        top: 6%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: #fef3c7;
        color: #92400e;
        width: 280px;
        height: 1px;
        padding: 30px;
        border: 2px solid #facc15;
        border-radius: 10px;
        z-index: 9999;
        animation: fadeIn 0.3s ease-in-out;
        font-weight: bold;
        text-align: center;
      }

      .hidden {
        display: none;
      }
    }
  </style>
</head>

<body>
  <header>
    <div class="header-container">
    <div style="display: flex; align-items: center; justify-content: center; gap: 10px;">
      <img src="img/logo.png" alt="Logo" class="logo">
      <div>
        <h1 style="margin: 0;">H·ªá Th·ªëng Gi√°m S√°t N√¥ng Tr·∫°i IoT</h1>
        <p style="margin: 0; margin: 10px auto 0 auto;">Qu·∫£n l√Ω - ƒêi·ªÅu khi·ªÉn - Quan s√°t t·ª´ xa</p>
      </div>
    </div>
      <div class="menu-toggle" onclick="toggleMenu()">
        ‚ò∞
        <div class="menu-label">M·ªü r·ªông</div>
      </div>

    </div>
  </header>


  <script>
    function toggleMenu() {
      document.querySelector('nav').classList.toggle('show');
    }
  </script>

  <nav id="navbar">
    <button class="tab-btn active" data-tab="status">Tr·∫°ng th√°i thi·∫øt b·ªã</button>
    <button class="tab-btn" data-tab="control">ƒêi·ªÅu khi·ªÉn thi·∫øt b·ªã</button>
    <button class="tab-btn" data-tab="nursery">C√¢y gi·ªëng</button>
    <button class="tab-btn" data-tab="other">Ch·ª©c nƒÉng kh√°c</button>
  </nav>
  </header>

  <!----------------- TAB 1: Tr·∫°ng th√°i thi·∫øt b·ªã ------------------------------------------------->

  <div id="status" class="tab-content active">
    <div class="card">
      <h2>Thi·∫øt b·ªã ƒëang ho·∫°t ƒë·ªông</h2>
      <div class="status-box" style= "font-size: 18px;">
        <div><img src="img/pumpbg.png" alt="B∆°m"> B∆°m: <span id="status-pump">--</span></div>
        <div><img src="img/mistbg.png" alt="Phun s∆∞∆°ng"> Phun s∆∞∆°ng: <span id="status-mist">--</span></div>
        <div><img src="img/valvebg.png" alt="Van x·∫£"> Van x·∫£: <span id="status-valve">--</span></div>
        <div><img src="img/denbg.png" alt="ƒê√®n"> ƒê√®n: <span id="status-light">--</span></div>
        <div><img src="img/fanbg.png" alt="Qu·∫°t"> Qu·∫°t: <span id="status-fan">--</span></div>
        <div><img src="img/valvebg2.png" alt="Van b∆°m"> Van T∆∞·ªõi: <span id="status-valve2">--</span></div>
      </div>
      
          <div class="info-mobile" style="margin-top:30px; text-align:center; font-size:19px;">
        <div>
          üå°Ô∏è Nhi·ªát ƒë·ªô:
          <strong id="nhietdo-value" style="display:block; margin-top:6px; font-size:24px;">-- ¬∞C</strong>
        </div>
        <div>
          üí¶ ƒê·ªô ·∫©m kh√¥ng kh√≠:
          <strong id="doam-value" style="display:block; margin-top:6px; font-size:24px;">-- %</strong>
        </div>
        <div>
          üîÖ √Ånh s√°ng:
          <strong id="anhsang-value" style="display:block; margin-top:6px; font-size:24px;">-- %</strong>
        </div>
        <div>
          üí¶ ƒê·ªô ·∫©m ƒë·∫•t:
          <strong id="doamdat-value" style="display:block; margin-top:6px; font-size:24px;">-- %</strong>
        </div>
      </div>

    </div>
    <!-- Popup c·∫£nh b√°o AUTO -->
    <div id="autoPopup" class="auto-popup hidden">
      <div class="popup-content">
        <p>‚ö†Ô∏è L∆∞u √Ω: Ch·∫ø ƒë·ªô AUTO ƒëang ho·∫°t ƒë·ªông</p>
      </div>
    </div>
  </div>

  <!--------------- TAB 2: ƒêi·ªÅu khi·ªÉn thi·∫øt b·ªã -------------------------------------------------->

  <div id="control" class="tab-content">
    <div class="card">
      <h2>ƒêi·ªÅu khi·ªÉn thi·∫øt b·ªã</h2>
      
      <div class="control-box">
        <div class="device-control">

          <!-- <button onclick="toggleDevice(this)">üíß B∆°m: T·∫ÆT</button> -->
          <img id="pum" src="img/pump.png" alt="B∆°m"/>
          <h3>B∆°m</h3>
          <div class="btn-group">
            <button id="btn1">B·∫≠t</button>
            <button id="btn2">T·∫Øt</button>
          </div>
        </div>
        <!-- <button onclick="toggleDevice(this)">‚òÅÔ∏è Phun s∆∞∆°ng: T·∫ÆT</button> -->
          <div class="device-control">
            <img id="mist" src="img/mist.png" alt="Phun s∆∞∆°ng"/>
            <h3>Phun s∆∞∆°ng</h3>
            <div class="btn-group">
              <button id="btn3">B·∫≠t</button>
              <button id="btn4">T·∫Øt</button>
            </div>
          </div>
          <!-- <button onclick="toggleDevice(this)">üí® Van x·∫£: T·∫ÆT</button> -->
          <div class="device-control">
            <img id="valve" src="img/valve.png" alt="Van x·∫£"/>
            <h3>Van x·∫£</h3>
            <div class="btn-group">
              <button id="btn5">B·∫≠t</button>
              <button id="btn6">T·∫Øt</button>
            </div>
          </div>
          <!-- <button onclick="toggleDevice(this)">üí° ƒê√®n: T·∫ÆT</button> -->
          <div class="device-control">
            <img id="light" src="img/den.png" alt="ƒê√®n"/>
            <h3>ƒê√®n</h3>
            <div class="btn-group">
              <button id="btn7">B·∫≠t</button>
              <button id="btn8">T·∫Øt</button>
            </div>
          </div>
        <!-- <button onclick="toggleDevice(this)">üí® Qu·∫°t: T·∫ÆT</button> -->
        <div class="device-control">
          <img id="fan" src="img/fan.png" alt="Qu·∫°t"/>
          <h3>Qu·∫°t</h3>
          <div class="btn-group">
            <button id="btn9">B·∫≠t</button>
            <button id="btn10">T·∫Øt</button>
          </div>
        </div>

        <!-- <button onclick="toggleDevice(this)">üí® valve2: T·∫ÆT</button> -->
        <div class="device-control">
          <img id="valve2" src="img/valve2.png" alt="Van b∆°m"/>
          <h3>Van t∆∞·ªõi</h3>
          <div class="btn-group">
            <button id="btn11">B·∫≠t</button>
            <button id="btn12">T·∫Øt</button>
          </div>
        </div>
      </div>
      
      <div class="control-box">
        <!-- N√∫t AUTO -->
        <div class="card" style="margin-top: 30px;">
          <div class="auto-row">
            <h2 style="display:inline">AUTO:</h2>
            <button id="autoBtn">OFF</button>
            <button id="attrBtn">?</button>
          </div>
          <span id="info">
            üëâKhi b·∫°n b·∫≠t ch·∫ø ƒë·ªô AUTO, h·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông ƒëi·ªÅu khi·ªÉn c√°c thi·∫øt b·ªã cho ph√π h·ª£p v·ªõi 
            m√¥i tr∆∞·ªùng, ƒë·∫£m b·∫£o c√¢y tr·ªìng ƒë∆∞·ª£c chƒÉm s√≥c ƒë√∫ng c√°ch ngay c·∫£ khi b·∫°n v·∫Øng m·∫∑t.
        </div>

      </div>
    </div>
  </div>

 <!-- -----------------TAB 3: Trang nu√¥i tr·ªìng c√¢y gi·ªëng ------------------------------------------------------->

<!-- C√¢y gi·ªëng ch√≠nh -->
  <div id="nursery" class="tab-content">
    <div class="card">
      <h2>C√°c lo·∫°i c√¢y gi·ªëng:</h2>
      <!-- ·∫¢nh ch√≠nh s·∫Ω ƒë∆∞·ª£c ƒë·ªïi sau khi ch·ªçn -->
      <div class="plant-detail">
        <div style="text-align: center;">
          <img id="mainImage" src="img/tree.png" alt="C√¢y gi·ªëng" onclick="openPopup()" style="cursor: pointer;" />
          <p style="margin-top:18px">üì∏ H√¨nh ·∫£nh c·∫≠p nh·∫≠t l√∫c <span id="timestamp">--:-- --/--/----</span></p>
        </div>
        <div class="plant-info">
          <h2 id="plant-name">T√™n c√¢y</h2>
          <p><strong>Th·ªùi gian thu ho·∫°ch:</strong> <span id="harvest-time">- -</span></p>
          <p id="plant-description">M√¥ t·∫£ c√¢y gi·ªëng</p>
          <div id="plant-conditions"></div>
        </div>
      </div>

      <!-- Popup ch·ªçn c√¢y -->
      <div id="plantPopup" class="pop">
        <div class="pop-content">
          <span class="close" onclick="closePopup()">&times;</span>
          <div class="plant-options">
            <div class="plant-item" onclick="selectPlantByName('C√¢y c·∫£i th√¨a')">
              <img src="img/thia.png" alt="C√¢y c·∫£i th√¨a">
              <p>C√¢y c·∫£i th√¨a</p>
            </div>
            <div class="plant-item" onclick="selectPlantByName('C√¢y x√† l√°ch')">
              <img src="img/xalach.png" alt="C√¢y x√† l√°ch">
              <p>C√¢y x√† l√°ch</p>
            </div>
            <div class="plant-item" onclick="selectPlantByName('C·∫£i b·∫π xanh')">
              <img src="img/bexanh.png" alt="C·∫£i b·∫π xanh">
              <p>C·∫£i b·∫π xanh</p>
            </div>
            <div class="plant-item" onclick="selectPlantByName('C√¢y c·∫£i ng·ªçt')">
              <img src="img/ngot.png" alt="C√¢y c·∫£i ng·ªçt">
              <p>C√¢y c·∫£i ng·ªçt</p>
            </div>
          </div>
        </div>
      </div>

      <div id="plant-detail" style="display: none;" class="plant-detail">
        <img id="plant-detail-image" src="" alt="·∫¢nh c√¢y gi·ªëng">
        <div class="plant-info">
          <h2 id="plant-name">T√™n c√¢y</h2>
          <p><strong>Th·ªùi gian thu ho·∫°ch:</strong> <span id="harvest-time">--</span></p>
          <p id="plant-description">M√¥ t·∫£ c√¢y gi·ªëng</p>
        </div>
      </div>

      <!-- Form nh·∫≠p ng√†y gieo tr·ªìng v√† ng√†y thu ho·∫°ch -->
      <h3 style="font-size: 24px;">Ch·ªçn ng√†y gieo tr·ªìng v√† ng√†y thu ho·∫°ch</h3>
      <form id="plant-form">
        <label for="planting-date">Ng√†y gieo tr·ªìng:</label>
        <input type="date" id="planting-date" required><br><br>
        <label for="harvest-date">Ng√†y thu ho·∫°ch:</label>
        <input type="date" id="harvest-date" required><br><br>
        <button type="submit">L∆∞u th√¥ng tin</button>
      </form>

      <!-- C·∫£nh b√°o ng√†y thu ho·∫°ch -->
      <div id="harvest-alert" style="display:none; color: yellow; font-size:24px; font-weight: bold; text-align:center; background-color: rgba(255, 0, 0, 0.7); padding: 10px; margin-top: 20px;">
        <p>‚ö†Ô∏è C·∫£nh b√°o ‚ö†Ô∏è: Ng√†y thu ho·∫°ch ƒë√£ ƒë·∫øn g·∫ßn!</p>
      </div>
    </div>
  </div>

  
  <script>
    window.onload = function() {
      
      // X·ª≠ l√Ω ng√†y gieo tr·ªìng v√† ng√†y thu ho·∫°ch
      const plantForm = document.getElementById('plant-form');
      const harvestAlert = document.getElementById('harvest-alert');
      
      // C·∫≠p nh·∫≠t timestamp
      const timestamp = document.getElementById('timestamp');
      const now = new Date();
      const formattedTime = now.toLocaleString('vi-VN', { hour: '2-digit', minute: '2-digit' }) + " " + now.toLocaleDateString('vi-VN');
      timestamp.innerText = formattedTime;

      // L·∫•y l·∫°i th√¥ng tin c√¢y ƒë√£ ch·ªçn t·ª´ localStorage n·∫øu c√≥
      const savedPlantName = localStorage.getItem("selected-plant-name");
      const savedPlantImage = localStorage.getItem("selected-plant-image");
      const savedPlantTime = localStorage.getItem("selected-plant-time");
      const savedPlantDescription = localStorage.getItem("selected-plant-description");

      if (savedPlantName && savedPlantImage && savedPlantTime && savedPlantDescription) {
        document.getElementById("mainImage").src = savedPlantImage;
        document.getElementById("plant-name").innerText = savedPlantName;
        document.getElementById("harvest-time").innerText = savedPlantTime;
        document.getElementById("plant-description").innerText = savedPlantDescription;
      }

      const savedPlantConditions = localStorage.getItem("selected-plant-conditions");
      if (savedPlantConditions) {
        document.getElementById("plant-conditions").innerHTML = savedPlantConditions;
      } else {
        document.getElementById("plant-conditions").innerHTML = "";
      }

      // Ki·ªÉm tra n·∫øu ƒë√£ c√≥ ng√†y gieo tr·ªìng v√† thu ho·∫°ch ƒë∆∞·ª£c l∆∞u tr·ªØ trong localStorage
      const savedPlantingDate = localStorage.getItem('planting-date');
      const savedHarvestDate = localStorage.getItem('harvest-date');
      if (savedPlantingDate && savedHarvestDate) {
        document.getElementById('planting-date').value = savedPlantingDate;
        document.getElementById('harvest-date').value = savedHarvestDate;
        checkHarvestDate(new Date(savedHarvestDate));
      }

      // X·ª≠ l√Ω khi ng∆∞·ªùi d√πng g·ª≠i form
      plantForm.addEventListener('submit', function(event) {
        event.preventDefault();
        const plantingDate = document.getElementById('planting-date').value;
        const harvestDate = document.getElementById('harvest-date').value;
        if (plantingDate && harvestDate) {
          // L∆∞u ng√†y gieo tr·ªìng v√† ng√†y thu ho·∫°ch
          localStorage.setItem('planting-date', plantingDate);
          localStorage.setItem('harvest-date', harvestDate);
          // Ki·ªÉm tra xem ng√†y thu ho·∫°ch ƒë√£ ƒë·∫øn ch∆∞a
          checkHarvestDate(new Date(harvestDate));
        }
      });

      // H√†m ki·ªÉm tra ng√†y thu ho·∫°ch
      function checkHarvestDate(harvestDate) {
        const currentDate = new Date();
        const timeDifference = harvestDate - currentDate;
        if (timeDifference <= 0) {
          // N·∫øu ng√†y thu ho·∫°ch ƒë√£ ƒë·∫øn
          harvestAlert.innerHTML = "<p>C·∫£nh b√°o: Ng√†y thu ho·∫°ch ƒë√£ ƒë·∫øn!</p>";
          harvestAlert.style.display = "block";
        } else {
          // N·∫øu ng√†y thu ho·∫°ch ch∆∞a ƒë·∫øn
          harvestAlert.style.display = "none";
        }
      }
    }
  </script>

  <!--------- TAB 4: Ch·ª©c nƒÉng kh√°c --------------------------------------------------------------->

  <div id="other" class="tab-content">
    <div class="card">
      <h2>Ch·ª©c nƒÉng b·ªï sung (ƒëang ph√°t tri·ªÉn)</h2>
      <p>Hi·ªán h·ªá th·ªëng ƒëang ph√°t tri·ªÉn th√™m...</p>
    </div>
  </div>

  <!------- ƒë·ªïi m√†u n√∫t nh·∫•n -------------->
  <script>
    const tabs = document.querySelectorAll('.tab-btn');
    const contents = document.querySelectorAll('.tab-content');

    tabs.forEach(btn => {
      btn.addEventListener('click', () => {
        tabs.forEach(b => b.classList.remove('active'));
        contents.forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(btn.dataset.tab).classList.add('active');

        // ·∫®n menu sau khi ch·ªçn tab n·∫øu ƒëang ·ªü mobile
        if (window.innerWidth <= 768) {
          document.getElementById('navbar').classList.remove('show');
        }
      });
    });

    const menuToggle = document.getElementById('menu-toggle');
    const navbar = document.getElementById('navbar');

    menuToggle.addEventListener('click', () => {
      navbar.classList.toggle('show');
    });

    // M·∫∑c ƒë·ªãnh ·∫©n nav tr√™n ƒëi·ªán tho·∫°i
    if (window.innerWidth <= 768) {
      navbar.classList.remove('show');
    }
  </script>

  <footer>
    <p>¬© 2025 Smart Farm - QU√ÅCH VƒÇN K·ª≤ 23661032 / L√ä VƒÇN NGU·ªíN 23661034</p>
  </footer>
  
  <!-- K·∫øt n·ªëi Firebase -->
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-database.js"></script>
  <!-- TODO: Add SDKs for Firebase products that you want to use
       https://firebase.google.com/docs/web/setup#available-libraries -->
  <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-analytics.js"></script>
  
  <script>
    // Firebase c·∫•u h√¨nh
    var firebaseConfig = {
      apiKey: "AIzaSyBaZgHe9UKU5Qe6FBgsW0VPmNHX028jzmU",
      authDomain: "smartfam-9256d.firebaseapp.com",
      databaseURL: "https://smartfam-9256d-default-rtdb.firebaseio.com",
      projectId: "smartfam-9256d",
      storageBucket: "smartfam-9256d.firebasestorage.app",
      messagingSenderId: "1020077202687",
      appId: "1:1020077202687:web:d27398e5fa0f1f609b00ca",
      measurementId: "G-1LXSHL9HDZ"
    };
    // Kh·ªüi t·∫°o Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
    // L·∫•y ph·∫ßn t·ª≠ DOM
    var nhietdo = document.getElementById('nhietdo-value');
    var doam = document.getElementById('doam-value');
    var anhsang = document.getElementById('anhsang-value');
    var doamdat = document.getElementById('doamdat-value');
    // ƒê·ªçc d·ªØ li·ªáu t·ª´ Firebase
    var dbRef = firebase.database().ref().child('cam_bien/nhietdo');  
    var dbRef2 = firebase.database().ref('cam_bien/doamkk');
    var dbRef3 = firebase.database().ref('cam_bien/anhsang');
    var dbRef4 = firebase.database().ref('cam_bien/doamdat');
    dbRef.on('value', snap => nhietdo.innerText = snap.val() + " ¬∞C");
    dbRef2.on('value', snap => doam.innerText = snap.val() + " %");
    dbRef3.on('value', snap => anhsang.innerText = snap.val()+ " %");
    dbRef4.on('value', snap => doamdat.innerText = snap.val() + " %"); 

    //----- C·∫¨P NH·∫¨T TR·∫†NG TH√ÅI THI·∫æT B·ªä T·ª™ FIREBASE ------------------------------------
    function updateUIFromFirebase(img, btnOn, btnOff, imgOnSrc, imgOffSrc, value) {
    if (value === 1) {
      img.src = imgOnSrc;
      btnOn.classList.add('active-on');
      btnOff.classList.remove('active-on', 'active-off');
    } else {
      img.src = imgOffSrc;
      btnOff.classList.add('active-off');
      btnOn.classList.remove('active-on', 'active-off');
    }}

    // ======== B∆†M ========================
    firebase.database().ref("thietbi1/bom").on('value', snapshot => {
      const value = snapshot.val();
      updateUIFromFirebase(imgpum, btn1, btn2, 'img/pumpon1.png', 'img/pump.png', value);
    });

    // ======== PHUN S∆Ø∆†NG ==================
    firebase.database().ref("thietbi2/phun_suong").on('value', snapshot => {
      const value = snapshot.val();
      updateUIFromFirebase(imgmist, btn3, btn4, 'img/miston.png', 'img/mist.png', value);
    });

    // ======== VAN X·∫¢ ======================
    firebase.database().ref("thietbi3/van_xa").on('value', snapshot => {
      const value = snapshot.val();
      updateUIFromFirebase(imgvalve, btn5, btn6, 'img/valveon.png', 'img/valve.png', value);
    });

    // ======== ƒê√àN =========================
    firebase.database().ref("thietbi4/den").on('value', snapshot => {
      const value = snapshot.val();
      updateUIFromFirebase(imglight, btn7, btn8, 'img/denon.png', 'img/den.png', value);
    });

    // ======== QU·∫†T ========================
    firebase.database().ref("thietbi5/quat").on('value', snapshot => {
      const value = snapshot.val();
      updateUIFromFirebase(imgfan, btn9, btn10, 'img/fanon.png', 'img/fan.png', value);
    });

     // ======== VAN B∆†M ========================
     firebase.database().ref("thietbi6/valve_watering").on('value', snapshot => {
      const value = snapshot.val();
      updateUIFromFirebase(imgvalve2, btn11, btn12, 'img/valve2on.png', 'img/valve2.png', value);
    });

    // ===============ƒê·ªåC TR·∫†NG TH√ÅI B·∫¨T/ T·∫ÆT C√ÅC THI·∫æT B·ªä===========================
    
    // DOM ph·∫ßn t·ª≠ hi·ªÉn th·ªã tr·∫°ng th√°i thi·∫øt b·ªã
    const statusPump = document.getElementById('status-pump');
    const statusMist = document.getElementById('status-mist');
    const statusValve = document.getElementById('status-valve');
    const statusLight = document.getElementById('status-light');
    const statusFan = document.getElementById('status-fan');
    const statusvalve2 = document.getElementById('status-valve2');


    // Ghi nh·∫≠n tr·∫°ng th√°i c√°c thi·∫øt b·ªã t·ª´ Firebase v√† c·∫≠p nh·∫≠t giao di·ªán
    function capNhatTrangThaiDuLieu(duongDan, element) {
      firebase.database().ref(duongDan).on('value', snapshot => {
        const value = snapshot.val();
        if (value === 1) {
          element.innerText = "B·∫¨T";
          element.style.color = "blue";
        } else {
          element.innerText = "T·∫ÆT";
          element.style.color = "red";
        }
      });
    }

    // G·ªçi h√†m cho t·ª´ng thi·∫øt b·ªã
    capNhatTrangThaiDuLieu("thietbi1/bom", statusPump);
    capNhatTrangThaiDuLieu("thietbi2/phun_suong", statusMist);
    capNhatTrangThaiDuLieu("thietbi3/van_xa", statusValve);
    capNhatTrangThaiDuLieu("thietbi4/den", statusLight);
    capNhatTrangThaiDuLieu("thietbi5/quat", statusFan);
    capNhatTrangThaiDuLieu("thietbi6/valve_watering", statusvalve2);


    // ============ AUTO BUTTON ==============================
    firebase.database().ref("autoBtn").on("value", (snapshot) => {
      const value = snapshot.val();
      if (value === 1) {
        btn.classList.add("on");
        btn.classList.remove("off");
        btn.textContent = "ON";
      } else {
        btn.classList.remove("on");
        btn.classList.add("off");
        btn.textContent = "OFF";
      }
    });
  </script>

  <script src="function.js"></script>

</body>
</html>
